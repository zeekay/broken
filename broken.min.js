var Broken=function(){"use strict";var t,e,n=t=function(){function t(t){this.state=t.state,this.value=t.value,this.reason=t.reason}return t.prototype.isFulfilled=function(){return"fulfilled"===this.state},t.prototype.isRejected=function(){return"rejected"===this.state},t}();e=function(){var t,e,n,r,o;return r=[],o=0,t=1024,e=function(){for(var e;r.length-o;){try{r[o]()}catch(t){e=t,"undefined"!=typeof console&&console.error(e)}r[o++]=void 0,o===t&&(r.splice(0,t),o=0)}},n=function(){var t,n;return"undefined"!=typeof MutationObserver?(t=document.createElement("div"),n=new MutationObserver(e),n.observe(t,{attributes:!0}),function(){t.setAttribute("a",0)}):"undefined"!=typeof setImmediate?function(){setImmediate(e)}:function(){setTimeout(e,0)}}(),function(t){r.push(t),r.length-o==1&&n()}}();var r,o,i,u,c,f,s,l=e;c=void 0,i=c,o="fulfilled",u="rejected",s=function(t,e){var n,r;if("function"==typeof t.y)try{r=t.y.call(c,e),t.p.resolve(r)}catch(e){n=e,t.p.reject(n)}else t.p.resolve(e)},f=function(t,e){var n,r;if("function"==typeof t.n)try{r=t.n.call(c,e),t.p.resolve(r)}catch(e){n=e,t.p.reject(n)}else t.p.reject(e)},r=function(){function t(t){t&&t(function(t){return function(e){return t.resolve(e)}}(this),function(t){return function(e){return t.reject(e)}}(this))}return t.prototype.resolve=function(t){var e,n,r,u;if(this.state===i){if(t===this)return this.reject(new TypeError("Attempt to resolve promise with self"));if(t&&("function"==typeof t||"object"==typeof t))try{if(r=!0,"function"==typeof(u=t.then))return void u.call(t,function(t){return function(e){r&&(r&&(r=!1),t.resolve(e))}}(this),function(t){return function(e){r&&(r=!1,t.reject(e))}}(this))}catch(t){return n=t,void(r&&this.reject(n))}this.state=o,this.v=t,(e=this.c)&&l(function(n){return function(){var n,r,o;for(r=0,o=e.length;r<o;r++)n=e[r],s(n,t)}}())}},t.prototype.reject=function(e){var n;this.state===i&&(this.state=u,this.v=e,(n=this.c)?l(function(){var t,r,o;for(r=0,o=n.length;r<o;r++)t=n[r],f(t,e)}):t.suppressUncaughtRejectionError||"undefined"==typeof console||console.log("Broken Promise, please catch rejections: ",e,e?e.stack:null))},t.prototype.then=function(e,n){var r,u,c,a;return c=new t,u={y:e,n:n,p:c},this.state===i?this.c?this.c.push(u):this.c=[u]:(a=this.state,r=this.v,l(function(){a===o?s(u,r):f(u,r)})),c},t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(t){return this.then(t,t)},t.prototype.timeout=function(e,n){return n=n||"timeout",new t(function(t){return function(r,o){setTimeout(function(){return o(Error(n))},e),t.then(function(t){r(t)},function(t){o(t)})}}(this))},t.prototype.callback=function(t){return"function"==typeof t&&(this.then(function(e){return t(null,e)}),this.catch(function(e){return t(e,null)})),this},t}();var a=r,h=function(t){var e;return e=new a,e.resolve(t),e},p=function(t){var e;return e=new a,e.reject(t),e},v=function(t){var e,n,r,o,i,u,c,f;for(c=[],i=0,f=new a,u=function(e,n){e&&"function"==typeof e.then||(e=h(e)),e.then(function(e){c[n]=e,++i===t.length&&f.resolve(c)},function(t){f.reject(t)})},e=n=0,r=t.length;n<r;e=++n)o=t[e],u(o,e);return t.length||f.resolve(c),f},y=function(t){return new a(function(e,r){return t.then(function(t){return e(new n({state:"fulfilled",value:t}))}).catch(function(t){return e(new n({state:"rejected",reason:t}))})})},d=function(t){return v(t.map(y))};return a.all=v,a.reflect=y,a.reject=p,a.resolve=h,a.settle=d,a.soon=l,a}();
